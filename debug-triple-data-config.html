<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>三数据组件配置问题诊断</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .status-section {
            background: #fff2e8;
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 20px;
            border-left: 4px solid #fa8c16;
        }
        .info-box {
            background: #f6ffed;
            padding: 15px;
            border-radius: 6px;
            margin: 10px 0;
            border-left: 4px solid #52c41a;
        }
        .code {
            background: #f6f8fa;
            padding: 10px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            margin: 10px 0;
            white-space: pre-wrap;
        }
        .btn {
            background: #1890ff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        .btn:hover {
            background: #40a9ff;
        }
        .problem {
            background: #fff1f0;
            padding: 15px;
            border-radius: 6px;
            margin: 10px 0;
            border-left: 4px solid #ff4d4f;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🔧 三数据组件配置问题诊断</h1>
        
        <div class="status-section">
            <h3>当前问题</h3>
            <p><strong>现象：</strong>三数据展示组件 (triple-data-display) 的配置面板看不见了</p>
            <p><strong>影响：</strong>无法配置组件的标题、颜色、布局等11个配置项</p>
        </div>

        <h3>📋 Card2.1 组件配置情况汇总</h3>
        
        <div class="info-box">
            <h4>✅ 已确认的组件配置</h4>
            <ul>
                <li><strong>simple-display</strong> - 7个配置项 (标题、内容、颜色、字体、图标等)</li>
                <li><strong>dual-data-display</strong> - 9个配置项</li>
                <li><strong>triple-data-display</strong> - 11个配置项 (最多的配置)</li>
                <li><strong>alarm-count</strong> - 统计组件 (有配置)</li>
            </ul>
        </div>

        <h3>🔍 triple-data-display 配置项详情</h3>
        
        <div class="info-box">
            <h4>该组件应有的11个配置项：</h4>
            <div class="code">1. 组件标题 (customize.title)
2. 数据源1标签 (customize.dataSource1Label)  
3. 数据源2标签 (customize.dataSource2Label)
4. 数据源3标签 (customize.dataSource3Label)
5. 单位 (customize.unit)
6. 数字格式 (customize.numberFormat) - 下拉选择
7. 布局模式 (customize.layout) - 网格/水平/垂直
8. 主题颜色 (customize.themeColor) - 颜色选择器
9. 字体大小 (customize.fontSize) - 数字输入
10. 显示边框 (customize.showBorder) - 开关</div>
        </div>

        <h3>🚨 问题排查</h3>
        
        <div class="problem">
            <h4>可能的原因分析：</h4>
            <ol>
                <li><strong>配置检查逻辑问题</strong> - 组件被错误标记为"无配置"</li>
                <li><strong>组件元数据传递问题</strong> - Visual Editor没有正确获取Card2.1组件的配置信息</li>
                <li><strong>配置面板组件加载问题</strong> - ComponentConfigForm组件无法找到配置组件</li>
                <li><strong>修复文件未生效</strong> - component-registry-fix.ts没有被正确导入</li>
            </ol>
        </div>

        <h3>🛠️ 诊断步骤</h3>
        
        <ol>
            <li>
                <button class="btn" onclick="window.open('http://localhost:5002/test/panel-editor-v2', '_blank')">
                    🚀 打开测试页面
                </button>
                <p>打开Panel Editor V2测试页面</p>
            </li>
            <li>添加一个 <strong>triple-data-display</strong> 组件到画布</li>
            <li>点击选中该组件，观察右侧配置面板</li>
            <li>查看浏览器控制台的日志输出</li>
        </ol>

        <h3>🔍 控制台调试检查</h3>
        
        <div class="info-box">
            <h4>应该看到的日志：</h4>
            <div class="code">[ComponentRegistry-Fix] 检查组件配置显示条件
[ComponentRegistry-Fix] 所有组件都显示配置面板: triple-data-display
[ComponentRegistry-Fix] 检查数据源配置显示条件  
[ComponentRegistry-Fix] 已知需数据源组件: triple-data-display</div>
        </div>

        <h3>⚠️ 如果问题依然存在</h3>
        
        <div class="problem">
            <p>如果修复后仍然看不到三数据组件的配置面板，问题可能是：</p>
            <ol>
                <li><strong>ConfigurationPanel.vue没有使用修复文件</strong></li>
                <li><strong>ComponentConfigForm找不到配置组件</strong></li>
                <li><strong>Card2.1组件的settingConfig没有正确传递</strong></li>
            </ol>
        </div>

        <button class="btn" onclick="checkImportStatus()">🔍 检查导入状态</button>
        <button class="btn" onclick="showExpectedBehavior()">📋 显示预期行为</button>
        
        <div id="debugOutput" style="margin-top: 20px;"></div>
    </div>

    <script>
        function checkImportStatus() {
            const output = document.getElementById('debugOutput');
            output.innerHTML = `
                <div class="info-box">
                    <h4>🔍 应该检查的文件状态</h4>
                    <div class="code">1. /src/components/visual-editor/configuration/component-registry-fix.ts (已创建)
2. ConfigurationPanel.vue 应导入: './component-registry-fix'
3. triple-data-display/settingConfig.ts (已确认有11个配置项)
4. triple-data-display/index.ts (已确认有完整定义)

检查方法：
- 查看ConfigurationPanel.vue的import语句
- 确认getVisibleConfigLayers来源于component-registry-fix
- 检查浏览器Network标签是否加载了修复文件</div>
                </div>
            `;
        }

        function showExpectedBehavior() {
            const output = document.getElementById('debugOutput');
            output.innerHTML = `
                <div class="info-box">
                    <h4>✅ 修复成功后的预期行为</h4>
                    <div class="code">选中triple-data-display组件后，右侧应该显示：

📋 配置面板标签页：
1. "基础配置" - 通用的位置、大小等设置
2. "组件配置" - triple-data-display特有的11个配置项
3. "数据源配置" - 三个数据源的配置
4. "交互配置" - 交互效果设置

🎯 组件配置页面应包含：
- 内容设置组：标题、数据源标签、单位
- 布局设置组：布局模式选择
- 样式设置组：主题颜色、字体大小、显示边框
- 格式设置组：数字格式选择</div>
                </div>
            `;
        }

        // 页面加载时的状态检查
        window.onload = function() {
            console.log('🔧 三数据组件配置问题诊断页面加载完成');
            console.log('📋 已确认triple-data-display有11个配置项');
            console.log('🎯 目标：确保配置面板正常显示');
        };
    </script>
</body>
</html>